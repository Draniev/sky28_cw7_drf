# Трекер привычек "Habits"

Habits - это веб-приложение для отслеживания и формирования полезных привычек. Вдохновленный книгой "Атомные привычки" Джеймса Клира, Habits помогает пользователям создавать, отслеживать и внедрять новые привычки, а также избавляться от старых негативных привычек.

## Основные возможности
Создание привычек: Пользователи могут создавать привычки, определяя конкретное действие, время и место выполнения, а также периодичность и признак приятной привычки.
Управление привычками: Пользователи могут редактировать, удалять и просматривать свои привычки, а также просматривать список публичных привычек других пользователей.
Напоминания: Пользователи получают напоминания о выполнении привычек в заданное время.
Интеграция с Телеграм: Приложение интегрировано с мессенджером Телеграм для рассылки уведомлений.

## Модели данных
### Привычка
- Пользователь: создатель привычки.
- Место: место, в котором необходимо выполнять привычку.
- Время: время, когда необходимо выполнять привычку.
- Действие: описание самой привычки.
- Признак приятной привычки: привычка, которую можно привязать к выполнению полезной привычки.
- Связанная привычка: привычка, которая связана с другой привычкой, важно указывать для полезных привычек, но не для приятных.
- Периодичность (по умолчанию ежедневная): периодичность выполнения привычки для напоминания в днях.
- Вознаграждение: чем пользователь должен себя вознаградить после выполнения.
- Время на выполнение: время, которое предположительно потратит пользователь на выполнение привычки.
- Признак публичности: привычки можно публиковать в общий доступ, чтобы другие пользователи могли брать в пример чужие привычки.

### Права доступа
- Каждый пользователь имеет доступ только к своим привычкам по механизму CRUD.
- Пользователь может видеть список публичных привычек без возможности их как-то редактировать или удалять.

### Эндпоинты API
- Регистрация: /api/sign-up/ (POST)
- Авторизация: /api/token/ (POST)
- Список привычек текущего пользователя с пагинацией: /api/habits/my (GET)
- Список публичных привычек всех пользователей с пагинацией: /api/habits/ (GET)
- Создание привычки: /api/habits/ (POST)
- Редактирование привычки: /api/habits/<habit_id>/ (PUT, PATCH)
- Удаление привычки: /api/habits/<habit_id>/ (DELETE)
- Верификация пользователя телеграм /api/verify/<verify_code>/ (GET)

### Интеграция с Телеграм
Приложение интегрировано с мессенджером Телеграм для рассылки уведомлений. Пользователи получают напоминания о выполнении привычек в заданное время.

### Зависимости
- Django
- Django REST Framework
- Celery
- Redis
- ... (всякие мелочи)


## Для запуска локально
Добавить файл с переменными среды .env, пример:
```editorconfig
SECRET=django-insecure-i-u2...
DB_NAME=postgres
DB_USER=postgres
DB_PASSWORD=postgres
DB_HOST=127.0.0.1
DB_PORT=5432
TELEGRAM_API=5280...
REDIS_HOST=127.0.0.1
```

Собрать и запустить контейнеры с базами данных:
```commandline
docker compose up
```
После инициализации базы данных установить фикстуры с днями недели командой 
```commandline
./manage.py loaddata weekdays.json
```
Запуск бота
```commandline
./manage.py runbot
```
Запуск воркера Celery
```commandline
celery -A config worker --loglevel=info
```
Запуск брокера Celery
```commandline
celery -A config beat --loglevel=info
```

## Для запуска в контейнере
Добавить файл с переменными среды .env.docker, пример:
```commandline
INTO_DOCKER=TRUE
SECRET=django-insecure-i-u29...
DB_NAME=postgres
DB_USER=postgres
DB_PASSWORD=postgres
DB_HOST=db
DB_PORT=5432
TELEGRAM_API=52803...
REDIS_HOST=redis
```
Добавить файл с настройками Postgres:
```commandline
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=postgres
```
Собрать и запустить контейнеры с базами данных:
```commandline
docker compose up
```
